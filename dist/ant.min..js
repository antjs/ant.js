Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var r=0,n=this.length;n>r;++r)r in this&&t.call(e,this[r],r,this)}),Array.isArray||(Array.isArray=function(t){return"[object Array]"==={}.toString.call(t)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){for(var r=e||0;r<this.length;r++)if(this[r]===t)return r;return-1}),function(t){var e=this;if("object"==typeof module&&module){var r=e.document||require("jsdom").jsdom();module.exports=t(r)}else t=t(e.document),"function"==typeof define&&define(function(){return t}),e.Ant||(e.Ant=t)}(function(t){"use strict";function e(t){var e,r=arguments.length;t=t||{};for(var n=1;r>n;n++)if(null!==(e=arguments[n]))for(var i in e)t[i]=e[i];return t}function r(t){t&&(D=t,S.IF=D+"if",S.REPEAT=D+"repeat",S.MODEL=D+"model",i.PREFIX=D)}function n(t){for(var e in S)if(S[e]===t)return!0;return!1}function i(t,r){r=r||{};var n,i=r.data||{},o=r.events||{},u=r.filters||{};n=a(t,r.el),t=n.tpl,n=n.el,this.options=r,this.tpl=t,this.el=n,this.data={},this.isRendered=!1,this.bindings=(this.bindings||[]).concat(r.bindings||[]),this._partials={},this._filters={};for(var h in o)this.on(h,o[h]);for(var c in u)this.setFilter(c,u[c]);this.trigger("beforeInit"),s(this),this.trigger("build"),i=e(this.data,i),r.data&&this.render(i),this.init.apply(this,arguments),this.trigger("afterInit")}function a(e,r){var n;return b(e)?(r?(n=r=b(r)?r:t.createElement(r),n.innerHTML="",r.appendChild(e)):n=e,e=n.outerHTML):(n=b(r)?r:t.createElement(r||"div"),n.innerHTML=e),{el:n,tpl:e}}function s(t){var e=new l;e.$$root=e,e.$$ant=t,t._vm=e,o(t.el,e)}function o(t,e){if(t.nodeType&&!t.length)u(t,e);else for(var r=0,n=t.length;n>r;r++)u(t[r],e)}function u(t,e){if(8!==t.nodeType){if(3===t.nodeType)return c(e,t,t.parentNode),void 0;if(!h(t,e))for(var r,n=t.firstChild;n;)r=n.nextSibling,u(n,e),n=r}}function h(t,e){var r,n=t.getAttributeNode(S.REPEAT),i=t.getAttributeNode(S.IF),a=t.getAttributeNode(S.MODEL),s=n||i;if(s)return c(e,s,t),!0;a&&c(e,a,t);for(var o=t.attributes.length-1;o>=0;o--)r=t.attributes[o],c(e,r,t),0===r.nodeName.indexOf(D)&&t.removeAttribute(r.nodeName)}function c(e,r,n){if(d(r.nodeValue)||d(r.nodeName)){var i=p(r,n),a=i.textMap;3===r.nodeType&&a.length>1?(a.forEach(function(i){var a=t.createTextNode(i);n.insertBefore(a,r),c(e,a,n)}),n.removeChild(r)):i.forEach(function(t){v(e,t)})}}function l(){this.$$path="",this.$watchers=[]}function f(t,e,r){var n,i,a;for(var s in e)n=t[s],i=e[s],t!==i&&"__ant__"!==s&&(x(i)||Array.isArray(i)?(a=Array.isArray(i)?n&&Array.isArray(n)?n:[]:n||{},t[s]=f(a,i,r&&r.$$getChild(s))):t[s]=i);return r&&Array.isArray(t)&&(t.__ant__=r,t.push!==U.push&&f(t,U)),t}function d(t){return F.lastIndex=0,t&&F.test(t)}function p(t,e){var r,i,a=[],s=[],o=0,u=t.nodeValue,h=t.nodeName;for(3===t.nodeType?i="text":2===t.nodeType&&(i="attr",0!==h.indexOf(D)||n(h)||(h=t.nodeName.slice(D.length)),d(h)&&(u=h)),F.lastIndex=0;r=F.exec(u);)F.lastIndex-o>r[0].length&&s.push(u.slice(o,F.lastIndex-r[0].length)),a.push({escape:!r[2],path:(r[2]||r[1]).trim(),position:s.length,el:e,node:t,nodeName:h,type:i,textMap:s}),s.push(r[0]),o=F.lastIndex;return u.length>o&&s.push(u.slice(o,u.length)),a.textMap=s,a}function v(t,e){var r=y(t.$$root.$$ant.bindings),n=r(t,e);n&&n.vm.$watchers.push(n)}function y(t){t=R.concat(t);for(var e=t[0],r=1,n=t.length;n>r;r++)e=N(e,t[r],function(t){return t instanceof g||t===!1});return e}function g(t,e,r,n){this.token=r,this.relativeVm=e,this.vm=t,this.val=null,this.fn=function(t){for(var r,i={},a=0,s=this.keys.length;s>a;a++)r=this.keys[a],i[r]=e.$$getData("."===r?"":r);var o=n(i);if(o!==this.val)try{this.update(o,t),this.val=o}catch(u){console.warn(u)}this.state=g.STATE_CALLED},this.keys=[],this.el=r.el,this.state=g.STATE_READY}function $(t,e,r){try{(e in t||"class"===e)&&j?"style"===e&&t.style.setAttribute?t.style.setAttribute("cssText",r):"class"===e?t.className=r:t[e]="boolean"==typeof t[e]?!0:r:t.setAttribute(e,r)}catch(n){}}function m(t,e,r){for(var n=t.__ant__.$watchers,i=!1,a=0,s=n.length;s>a;a++)n[a].type===S.REPEAT&&(n[a][e](r,t,i),i=!0);t.__ant__.$$root.$$ant.trigger("update")}function A(){}function b(t){return"object"==typeof t&&null!==t}function E(t){return"undefined"==typeof t}function _(t){return"function"==typeof t}function x(t){return!t||"[object Object]"!=={}.toString.call(t)||t.nodeType||t===t.window?!1:!0}function N(t,e,r){return function(){var n=e.apply(this,arguments);return r&&r.call(this,n)?n:t.apply(this,arguments)}}function w(t,e,r){return function(){var n=t.apply(this,arguments);return r&&r.call(this,n)?n:(e.apply(this,arguments),n)}}function T(t){return t.replace(z,"").split(H)}function k(t,r,n){if(t){var i=T(t),a=n;i.forEach(function(t,e){e===i.length-1?a[t]=r:a&&a.hasOwnProperty(t)?a=a[t]:(a[t]={},a=a[t])})}else e(n,r);return n}function C(t,e){var r,n,i=e;if(t){r=T(t);for(var a=0,s=r.length;s>a;a++){if(n=r[a],!i||!i.hasOwnProperty(n))return;i=i[n]}}return i}function P(t,e,r){t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent("on"+e,r)}function L(t,e,r){t.removeEventListener?t.removeEventListener(e,r):t.detachEvent("on"+e,r)}var D,I={on:function(t,e,r){var n=r||this;return n._handlers=n._handlers||{},n._handlers[t]=n._handlers[t]||[],n._handlers[t].push({handler:e,context:r,ctx:n}),this},off:function(t,e,r){var n=r||this,i=n._handlers;if(t&&i[t])if(_(e))for(var a=i[t].length-1;a>=0;a--)i[t][a].handler===e&&i[t].splice(a,1);else i[t]=[];return this},trigger:function(t){var e=this,r=[].slice.call(arguments,1),n=e._handlers;return n&&n[t]&&n[t].forEach(function(t){t.handler.apply(e,r)}),this}},O={extend:function(t,r,n){_(r)&&(n=r,r={}),_(t)&&(n=t,t={});var i=this;n=n||function(){return i.apply(this,arguments)};var a=function(){this.constructor=n};return a.prototype=i.prototype,n.prototype=new a,e(n.prototype,t,{__super__:i}),e(n,i,r),n}},S={};r("a-"),e(i,O,{setPrefix:r,Event:I,doc:t}),e(i.prototype,I,{update:function(t,e,r){var n,i=this._vm;return b(t)?(r=e,n=e=t):"string"==typeof t?(t=T(t).join("."),E(e)&&(e=this.get(t)),n=k(t,e,{}),i=i.$$getChild(t)):e=this.data,E(r)&&(r=b(t)),i.$$render(e,r),this.trigger("update",n),this},render:function(t){return t&&this.set(t,{isExtend:!1,silence:!0}),this._vm.$$render(this.data,!1),this.isRendered=!0,this.trigger("render"),this},clone:function(t){var e=f({},this.options);return t&&t.data&&(e.data=null),new this.constructor(this.tpl,f(e,t))},get:function(t){return C(t,this.data)},set:function(t,e,r){var n,i,a,s,o;if(E(t))return this;if(b(t))n=!0,r=e,r=r||{},r.isExtend!==!1?(i=!0,f(this.data,t,this._vm)):(i=!1,this.data=f({},t,this._vm));else if(r=r||{},C(t,this.data)!==e&&(n=!0),n)if(r.isExtend!==!0){if(s=T(t),s.length>1){if(o=s.pop(),a=C(s.join("."),this.data),E(a))k(s.join("."),a={},this.data);else if(!b(a)){var u=a;k(s.join("."),a={toString:function(){return u}},this.data)}}else t?(a=this.data,o=t):(a=this,o="data");a[o]=b(e)?f(Array.isArray(e)?[]:{},e,this._vm.$$getChild(t,!Array.isArray(e))):e,i=!1}else f(this.data,k(t,e,{}),this._vm),i=!0;return n&&!r.silence&&(b(t)?this.update(t,i):this.update(t,e,i)),this},setPartial:function(r){if(r){r=e({},this._partials[r.name],r);var n,s,u,h=r.name,c=r.target,l=r.content,f=r.path||"";if(h&&(this._partials[h]=r),l){if(u=this._vm.$$getChild(f),"string"==typeof l)if(r.escape)n=[t.createTextNode(l)];else{s=a(l,"div").el.childNodes,n=[];for(var d=0,p=s.length;p>d;d++)n.push(s[d])}else n=[l instanceof i?l.el:l];if(c)for(var d=0,p=n.length;p>d;d++)_(c)?c.call(this,n[d]):c.appendChild(n[d]);o(n,u),this.isRendered&&u.$$render(C(f,this.data))}return this}},init:A,watch:function(t,e){var r=this,n=this._vm.$$getChild(t),i=new g(n,n,{},function(e){return e[t]});i.addKey(t),i.callback=e,i.update=function(t){e.call(r,t,r.val),r.val=t},n.$watchers.push(i)},unwatch:function(){},setFilter:function(t,e){this._filters[t]=e},getFilter:function(t){return this._filters[t]},removeFilter:function(t){delete this._filters[t]}});var j=!!t.attachEvent;l.prototype={$$root:null,$$parent:null,$$ant:null,$$path:null,$watchers:null,$$getChild:function(t,e){var r,n,i,a=this;if(t+=""){i=t.split(/(?!^)\.(?!$)/);for(var s=0,o=i.length;o>s;s++){if(r=i[s],!a[r]){if(e)return null;n=new l,n.$$parent=a,n.$$root=a.$$root||a,n.$$path=r,a[r]=n}a=a[r]}}return a},$$getKeyPath:function(){for(var t=this.$$path,e=this;(e=e.$$parent)&&e.$$path;)t=e.$$path+"."+t;return t},$$getData:function(t,e){var r=C(t,this.$$root.$$ant.get(this.$$getKeyPath()));return!e&&this.$$parent&&E(r)?this.$$parent.$$getData(t):r},$$render:function(t,e){for(var r=e?t:this,n=0,i=this.$watchers.length;i>n;n++)this.$watchers[n].fn(e);if(b(r))for(var a in r)!this.hasOwnProperty(a)||a in l.prototype||this[a].$$render(t?t[a]:void 0,e)}};var F=/{{({([^{}\n]+)}|[^{}\n]+)}}/g,M=/^\^/,B=/^>\s*(?=.+)/,K=/\s*\|(?!\|)\s*/,R=[function(t,e){var r,n,i=e.path,a=i.split(K),s=t.$$root.$$ant;return a.length>=1?(i=a.shift(),n="."===i?t:t.$$getChild(i),r=new g(n,t,e,function(t){for(var e=t[i],r=0,n=a.length;n>r;r++)s._filters[a[r]]?e=s._filters[a[r]].call(s,e):console.error("Filter: "+a[r]+" not found!");return e}),r.addKey(i),r):void 0},function(t,e){var r=e.path,n=r.split(":");if(2===n.length){var i=n[0].trim(),a=i.replace(M,""),s=n[1].trim(),o=new g(t.$$getChild(a),t,e,function(t){var e=t[a];return(M.test(i)?!e:e)?s:""});return o.addKey(a),o}},function(e,r){var n,i,a,s;return"text"===r.type&&B.test(r.path)?(n=r.path.replace(B,""),i=e.$$root.$$ant,a=i.options,s=t.createTextNode(""),r.el.insertBefore(s,r.node),r.el.removeChild(r.node),i.setPartial({name:n,content:a&&a.partials&&a.partials[n],target:function(t){r.el.insertBefore(t,s)},escape:r.escape,path:e.$$getKeyPath()}),!1):void 0},function(t,e){var r,n=e.nodeName,i=e.path;switch(n){case S.IF:i=i.replace(M,"");case S.REPEAT:r=t.$$getChild(i);var a=new V(r,t,e,function(t){return t[i]});return a.addKey(i),a}},function(t,e){var r=e.path,n=e.el;if(e.nodeName===S.MODEL){if(!r)return!1;var i,a=t.$$root.$$ant,s="."===r?t:t.$$getChild(r),o="change",u=i="value",h=E(a.get(s.$$getKeyPath())),c=/\r\n/g,l=function(e){var a=e||t.$$getData(r)||"",e=n[i];e&&e.replace&&(e=e.replace(c,"\n")),a!==e&&(n[i]=a)},f=function(){var t=n[u];t.replace&&(t=t.replace(c,"\n")),a.set(s.$$getKeyPath(),t)};switch(n.tagName){default:u=i="innerHTML",o+=" blur";case"INPUT":case"TEXTAREA":switch(n.type){case"checkbox":u=i="checked",j&&(o+=" click");break;case"radio":i="checked",j&&(o+=" click"),l=function(){n.checked=n.value===t.$$getData(r)},h=n.checked;break;default:a.options.lazy||("oninput"in n&&(o+=" input"),j&&(o+=" keyup propertychange cut"))}break;case"SELECT":n.multiple&&(f=function(){for(var t=[],e=0,r=n.options.length;r>e;e++)n.options[e].selected&&t.push(n.options[e].value);a.set(s.$$getKeyPath(),t)},l=function(){var e=t.$$getData(r);if(e&&e.length)for(var i=0,a=n.options.length;a>i;i++)n.options[i].selected=-1!==e.indexOf(n.options[i].value)}),h=h&&!d(n[u])}o.split(/\s+/g).forEach(function(t){L(n,t,f),P(n,t,f)}),n.removeAttribute(S.MODEL);var p=new g(t,s,e,function(t){return t[r]});return p.update=l,p.addKey(r),n[u]&&h&&f(),p}}];e(g,{STATE_READY:0,STATE_CALLED:1},O),e(g.prototype,{addKey:function(t){this.keys.push(t)},update:function(e){var r,n=this.token,i=n.position,a=n.node,s=n.el,o=n.type,u=n.textMap,h=n.nodeName,c=d(a.nodeName);if(e+""!=u[i]+""){if((c?h:a.nodeValue)!==u.join("")&&n.escape)return console.warn("模板内容被修改!"),void 0;if(u[i]=e&&e+"",r=u.join(""),n.escape||"text"!==o)c||(a.nodeValue=r),"text"!==o&&(c?(h&&s.removeAttribute(h),r&&$(s,r,a.nodeValue),n.nodeName=r):$(s,h,r));else{var l,f=t.createElement("div");n.unescapeNodes=n.unescapeNodes||[],f.innerHTML=r,l=f.childNodes,n.unescapeNodes.forEach(function(t){t.parentNode&&t.parentNode.removeChild(t)}),n.unescapeNodes=[];for(var p=0,v=l.length;v>p;p++)n.unescapeNodes.push(l[p]),a.parentNode.insertBefore(l[p],a),p--,v--;a.nodeValue=""}}}});var U={splice:w([].splice,function(){m(this,"splice",[].slice.call(arguments))}),push:w([].push,function(){var t=[].slice.call(arguments);t.unshift(this.length-t.length,0),m(this,"splice",t)}),pop:w([].pop,function(){m(this,"splice",[this.length,1])}),shift:w([].shift,function(){m(this,"splice",[0,1])}),unshift:w([].unshift,function(){var t=[].slice.call(arguments);t.unshift(0,0),m(this,"splice",t)}),sort:w([].sort,function(){m(this,"sort")}),reverse:w([].reverse,function(){m(this,"reverse")})},V=g.extend({update:function(t,e){var r=this,t=this.relativeVm.$$getData(this.path.replace(M,""));if(r.type===S.REPEAT){if(t&&!Array.isArray(t))return console.warn("需要一个数组"),void 0;0!==this.state&&e||t&&this.splice([0,this.els.length].concat(t))}else M.test(this.path)&&(t=!t),t?r.lastIfState||r.relateEl.parentNode.insertBefore(r.el,r.relateEl):r.lastIfState&&r.el.parentNode.removeChild(r.el),r.lastIfState=t},splice:function(e,r,n){var i,a,s=this.els,o=e.slice(2),h=1*e[0],c=1*e[1],l=o.length,d=[],p=t.createDocumentFragment(),v=this.relateEl.parentNode;E(c)&&(e[1]=c=s.length-h);for(var y=h,g=s.length;g>y;y++)if(h+c>y){try{v.removeChild(s[y])}catch($){}n||delete this.vm[y]}else{if(!c&&!l)break;var m=y-(c-l);s[y][D+"index"]=m,n||(a=this.vm[m]=this.vm[y],a.$$path=m+"")}for(var m=0;l>m;m++)i=this.el.cloneNode(!0),n||delete this.vm[h+m],a=this.vm.$$getChild(h+m),i[D+"index"]=h+m,p.appendChild(i),u(i,a),a.$$render(o[m]),d.push(i),r&&b(r[h+m])&&(r[h+m]=f(Array.isArray(r[h+m])?[]:{},r[h+m],a));if(d.length&&v.insertBefore(p,s[h+c]||this.relateEl),!n)for(var A=g-c+l;g>A;A++)delete this.vm[A];e=e.slice(0,2).concat(d),s.splice.apply(s,e),c!==l&&this.vm.$$getChild("length").$$render(s.length)},reverse:function(e,r,n){for(var i,a=this.vm,s=this.relateEl,o=t.createDocumentFragment(),u=0,h=this.els.length;h>u;u++)!n&&.5>u&&(i=a[u],a[u]=a[h-u-1],a[u].$$path=u+"",i.$$path=h-u-1+"",a[h-u-1]=i),this.els[u][D+"index"]=h-u-1,o.appendChild(this.els[h-u-1]);s.parentNode.insertBefore(o,s),this.els.reverse()},sort:function(){this.update()}},function(e,r,n){var i=t.createTextNode(""),a=n.el,s=n.nodeName;this.__super__.apply(this,arguments),this.path=n.path,a.removeAttribute(s),this.type=s,this.relateEl=i,this.els=[],s===S.IF&&u(this.el,r),a.parentNode.insertBefore(i,a),a.parentNode.removeChild(a)}),H=/(?:\.|\[)/g,z=/\]/g;return i}),function(t){var e=function(t,e,r){var n,i,a,s,o,u=0,h=t.length,c=[],l=function(t,e){return{type:t,value:e,from:i,to:u}};if(t){for("string"!=typeof e&&(e="<>+-&"),"string"!=typeof r&&(r="=>&:"),n=t.charAt(u);n;)if(i=u," ">=n)u+=1,n=t.charAt(u);else if(n>="a"&&"z">=n||n>="A"&&"Z">=n){for(o=n,u+=1;n=t.charAt(u),n>="a"&&"z">=n||n>="A"&&"Z">=n||n>="0"&&"9">=n||"_"===n;)o+=n,u+=1;c.push(l("name",o))}else if(n>="0"&&"9">=n){for(o=n,u+=1;n=t.charAt(u),!("0">n||n>"9");)u+=1,o+=n;if("."===n)for(u+=1,o+=n;n=t.charAt(u),!("0">n||n>"9");)u+=1,o+=n;if("e"===n||"E"===n){u+=1,o+=n,n=t.charAt(u),("-"===n||"+"===n)&&(u+=1,o+=n,n=t.charAt(u)),("0">n||n>"9")&&l("number",o).error("Bad exponent");do u+=1,o+=n,n=t.charAt(u);while(n>="0"&&"9">=n)}n>="a"&&"z">=n&&(o+=n,u+=1,l("number",o).error("Bad number")),a=+o,isFinite(a)?c.push(l("number",a)):l("number",o).error("Bad number")}else if("'"===n||'"'===n){for(o="",s=n,u+=1;n=t.charAt(u)," ">n&&l("string",o).error("\n"===n||"\r"===n||""===n?"Unterminated string.":"Control character in string.",l("",o)),n!==s;){if("\\"===n)switch(u+=1,u>=h&&l("string",o).error("Unterminated string"),n=t.charAt(u)){case"b":n="\b";break;case"f":n="\f";break;case"n":n="\n";break;case"r":n="\r";break;case"t":n="	";break;case"u":u>=h&&l("string",o).error("Unterminated string"),n=parseInt(t.substr(u+1,4),16),(!isFinite(n)||0>n)&&l("string",o).error("Unterminated string"),n=String.fromCharCode(n),u+=4}o+=n,u+=1}u+=1,c.push(l("string",o)),n=t.charAt(u)}else if("/"===n&&"/"===t.charAt(u+1))for(u+=1;n=t.charAt(u),"\n"!==n&&"\r"!==n&&""!==n;)u+=1;else if(e.indexOf(n)>=0){for(o=n,u+=1;;){if(n=t.charAt(u),u>=h||r.indexOf(n)<0)break;o+=n,u+=1}c.push(l("operator",o))}else u+=1,c.push(l("operator",n)),n=t.charAt(u);return c}},r=Object.create||function(t){function e(){}return e.prototype=t,new e},n=function(){var t,n,i,a={},s=function(){return this},o=function(t){return t.nud=s,t.led=null,t.std=null,t.lbp=0,t},u=function(e){var s,u,h,c;return e&&t.id!==e&&t.error("Expected '"+e+"'."),i>=n.length?(t=a["(end)"],void 0):(h=n[i],i+=1,c=h.value,s=h.type,"name"===s?u=o(h):"operator"===s?(u=a[c],u||h.error("Unknown operator.")):"string"===s||"number"===s?(u=a["(literal)"],s="literal"):h.error("Unexpected token."),t=r(u),t.from=h.from,t.to=h.to,t.value=c,t.arity=s,t)},h=function(e){var r,n=t;for(u(),r=n.nud();e<t.lbp;)n=t,u(),r=n.led(r);return r},c={nud:function(){this.error("Undefined.")},led:function(){this.error("Missing operator.")},error:function(t,e){throw e=e||this,e.name="SyntaxError",e.message=t,e}},l=function(t,e){var n=a[t];return e=e||0,n?e>=n.lbp&&(n.lbp=e):(n=r(c),n.id=n.value=t,n.lbp=e,a[t]=n),n},f=function(t,e){var r=l(t);return r.nud=function(){return this.value=a[this.id].value,this.arity="literal",this},r.value=e,r},d=function(t,e,r){var n=l(t,e);return n.led=r||function(t){return this.first=t,this.second=h(e),this.arity="binary",this},n},p=function(t,e,r){var n=l(t,e);return n.led=r||function(t){return this.first=t,this.second=h(e-1),this.arity="binary",this},n},v=function(t,e){var r=l(t);return r.nud=e||function(){return this.first=h(70),this.arity="unary",this},r};l("(end)"),l("(name)"),l(":"),l(")"),l("]"),l("}"),l(","),f("true",!0),f("false",!1),f("null",null),l("(literal)").nud=s,l("this").nud=function(){return this.arity="this",this},d("?",20,function(t){return this.first=t,this.second=h(0),u(":"),this.third=h(0),this.arity="ternary",this}),p("&&",30),p("||",30),p("===",40),p("!==",40),p("<",40),p("<=",40),p(">",40),p(">=",40),d("+",50),d("-",50),d("*",60),d("/",60),d(".",80,function(e){return this.first=e,"name"!==t.arity&&t.error("Expected a property name."),t.arity="literal",this.second=t,this.arity="binary",u(),this}),d("[",80,function(t){return this.first=t,this.second=h(0),this.arity="binary",u("]"),this}),d("(",80,function(e){var r=[];if("."===e.id||"["===e.id?(this.arity="ternary",this.first=e.first,this.second=e.second,this.third=r):(this.arity="binary",this.first=e,this.second=r,"unary"===e.arity&&"function"===e.id||"name"===e.arity||"("===e.id||"&&"===e.id||"||"===e.id||"?"===e.id||e.error("Expected a variable name.")),")"!==t.id)for(;;){if(r.push(h(0)),","!==t.id)break;u(",")}return u(")"),this}),v("!"),v("-"),v("typeof"),v("(",function(){var t=h(0);return u(")"),t}),v("[",function(){var e=[];if("]"!==t.id)for(;;){if(e.push(h(0)),","!==t.id)break;u(",")}return u("]"),this.first=e,this.arity="unary",this}),v("{",function(){var e,r,n=[];if("}"!==t.id)for(;;){if(e=t,"name"!==e.arity&&"literal"!==e.arity&&t.error("Bad property name."),u(),u(":"),r=h(0),r.key=e.value,n.push(r),","!==t.id)break;u(",")}return u("}"),this.first=n,this.arity="unary",this});var y=function(t){n=e(t,"=<>!+-*&|/%^","=<>&|"),i=0,u();var r=h(0);return u("(end)"),r};return y},i={"+":function(t){return+t},"-":function(t){return-t},"!":function(t){return!t}},a={"+":function(t,e){return t+e},"-":function(t,e){return t-e},"*":function(t,e){return t*e},"/":function(t,e){return t/e},"%":function(t,e){return t%e},"<":function(t,e){return e>t},">":function(t,e){return t>e},"<=":function(t,e){return e>=t},">=":function(t,e){return t>=e},"==":function(t,e){return t==e},"!=":function(t,e){return t!=e},"===":function(t,e){return t===e},"!==":function(t,e){return t!==e},"&&":function(t,e){return t&&e},"||":function(t,e){return t||e},".":function(t,e){return t[e]},"[":function(t,e){return t[e]}},s={"?":function(t,e,r){return t?e:r},"(":function(t,e,r){return t[e].apply(t,r)}},o=function(){var t,e=function(r){var n,o,u=r.arity,h=r.first&&!Array.isArray(r.first)&&e(r.first),c=r.second&&e(r.second),l=r.third&&e(r.third),f=r.value;if(Array.isArray(r.first)){h=r.first,n="["===f;for(var o=n?[]:{},d=0,p=h.length;p>d;d++)n?o.push(e(h[d])):o[h[d].key]=e(h[d]);return o}switch(u){case"unary":return i[f](h);case"binary":return a[f](h,c);case"ternary":return s[f](h,c,l);case"literal":return f;case"name":return t[f]}};return function(r,n){return t=n||{},e(r)}},u=n();u.evaluate=o(),t.parse=u}(Ant);