/*! ant.js 2013-11-17 10:52 */
Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=0,d=this.length;d>c;++c)c in this&&a.call(b,this[c],c,this)}),Array.isArray||(Array.isArray=function(a){return"[object Array]"==={}.toString.call(a)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0;c<this.length;c++)if(this[c]===a)return c;return-1}),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),function(a){var b=this;if("object"==typeof module&&module){var c=b.document||require("jsdom").jsdom();module.exports=a(c)}else a=a(b.document),"function"==typeof define&&define(function(){return a}),b.Ant||(b.Ant=a)}(function(a){"use strict";function b(a){var b,c=arguments.length;a=a||{};for(var d=1;c>d;d++)if(null!==(b=arguments[d]))for(var e in b)a[e]=b[e];return a}function c(a){a&&(G=a,J.IF=G+"if",J.REPEAT=G+"repeat",J.MODEL=G+"model",e.PREFIX=G)}function d(a){for(var b in J)if(J[b]===a)return!0;return!1}function e(a,c){c=c||{};var d,e=c.data||{},h=c.events||{},i=c.filters||{};d=f(a,c.el),a=d.tpl,d=d.el,this.options=c,this.tpl=a,this.el=d,this.data={},this.isRendered=!1,this.bindings=(this.bindings||[]).concat(c.bindings||[]),this._partials={},this._filters={};for(var j in h)this.on(j,h[j]);for(var k in i)this.setFilter(k,i[k]);this.trigger("beforeInit"),g(this),this.trigger("build"),e=b(this.data,e),c.data&&this.render(e),this.init.apply(this,arguments),this.trigger("afterInit")}function f(b,c){var d;return v(b)?(c?(d=c=v(c)?c:a.createElement(c),d.innerHTML="",c.appendChild(b)):d=b,b=d.outerHTML):(d=v(c)?c:a.createElement(c||"div"),d.innerHTML=b),{el:d,tpl:b}}function g(a){var b=new l;b.$root=b,b.$ant=a,a._vm=b,h(a.el,b)}function h(a,b){if(a.nodeType&&!a.length)i(a,b);else for(var c=0,d=a.length;d>c;c++)i(a[c],b)}function i(a,b){if(8!==a.nodeType){if(3===a.nodeType)return k(b,a,a.parentNode),void 0;if(!j(a,b))for(var c,d=a.firstChild;d;)c=d.nextSibling,i(d,b),d=c}}function j(a,b){var c,d=a.getAttributeNode(J.REPEAT),e=a.getAttributeNode(J.IF),f=a.getAttributeNode(J.MODEL),g=d||e;if(g)return k(b,g,a),!0;f&&k(b,f,a);for(var h=a.attributes.length-1;h>=0;h--)c=a.attributes[h],k(b,c,a),0===c.nodeName.indexOf(G)&&a.removeAttribute(c.nodeName)}function k(b,c,d){if(n(c.nodeValue)||n(c.nodeName)){var e=o(c,d),f=e.textMap;3===c.nodeType&&f.length>1?(f.forEach(function(e){var f=a.createTextNode(e);d.insertBefore(f,c),k(b,f,d)}),d.removeChild(c)):e.forEach(function(a){p(b,a)})}}function l(){this.$path="",this.$watchers=[]}function m(a,b,c){var d,e,f;for(var g in b)d=a[g],e=b[g],a!==e&&"__ant__"!==g&&(y(e)||Array.isArray(e)?(f=Array.isArray(e)?d&&Array.isArray(d)?d:[]:d||{},a[g]=m(f,e,c&&c.$getChild(g))):a[g]=e);return c&&Array.isArray(a)&&(a.__ant__=c,a.push!==P.push&&m(a,P)),a}function n(a){return L.lastIndex=0,a&&L.test(a)}function o(a,b){var c,e,f=[],g=[],h=0,i=a.nodeValue,j=a.nodeName;for(3===a.nodeType?e="text":2===a.nodeType&&(e="attr",0!==j.indexOf(G)||d(j)||(j=a.nodeName.slice(G.length)),n(j)&&(i=j)),L.lastIndex=0;c=L.exec(i);)L.lastIndex-h>c[0].length&&g.push(i.slice(h,L.lastIndex-c[0].length)),f.push({escape:!c[2],path:(c[2]||c[1]).trim(),position:g.length,el:b,node:a,nodeName:j,type:e,textMap:g}),g.push(c[0]),h=L.lastIndex;return i.length>h&&g.push(i.slice(h,i.length)),f.textMap=g,f}function p(a,b){var c=q(a.$root.$ant.bindings);c(a,b)}function q(a){a=N.concat(a);for(var b=a[0],c=1,d=a.length;d>c;c++)b=z(b,a[c],function(a){return a instanceof r||a===!1});return b}function r(a,b){this.token=b,this.relativeVm=a,this.ant=a.$root.$ant,this.keys=[],this.filters=[],O.call(this,b.path);for(var c=0,d=this.keys.length;d>c;c++)a.$getChild(this.keys[c]).$watchers.push(this);this.val=null,this.fn=function(b){for(var c,d={},e=0,f=this.keys.length;f>e;e++)c=this.keys[e],"."===c?d=a.$getData():d[c]=a.$getData(c);var g=this.getValue(d);if(g!==this.val)try{this.update(g,b),this.val=g}catch(h){console.warn(h)}this.state=r.STATE_CALLED},this.el=b.el,this.state=r.STATE_READY}function s(a,b,c){try{(b in a||"class"===b)&&K?"style"===b&&a.style.setAttribute?a.style.setAttribute("cssText",c):"class"===b?a.className=c:a[b]="boolean"==typeof a[b]?!0:c:a.setAttribute(b,c)}catch(d){}}function t(a,b,c){for(var d=a.__ant__.$watchers,e=!1,f=0,g=d.length;g>f;f++)d[f].type===J.REPEAT&&(d[f][b](c,a,e),e=!0);a.__ant__.$root.$ant.trigger("update")}function u(){}function v(a){return"object"==typeof a&&null!==a}function w(a){return"undefined"==typeof a}function x(a){return"function"==typeof a}function y(a){return!a||"[object Object]"!=={}.toString.call(a)||a.nodeType||a===a.window?!1:!0}function z(a,b,c){return function(){var d=b.apply(this,arguments);return c&&c.call(this,d)?d:a.apply(this,arguments)}}function A(a,b,c){return function(){var d=a.apply(this,arguments);return c&&c.call(this,d)?d:(b.apply(this,arguments),d)}}function B(a){return a.replace(S,"").split(R)}function C(a,c,d){if(a){var e=B(a),f=d;e.forEach(function(a,b){b===e.length-1?f[a]=c:f&&f.hasOwnProperty(a)?f=f[a]:(f[a]={},f=f[a])})}else b(d,c);return d}function D(a,b){var c,d,e=b;if(a){c=B(a);for(var f=0,g=c.length;g>f;f++){if(d=c[f],!e||!e.hasOwnProperty(d))return;e=e[d]}}return e}function E(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function F(a,b,c){a.removeEventListener?a.removeEventListener(b,c):a.detachEvent("on"+b,c)}var G,H={on:function(a,b,c){var d=c||this;return d._handlers=d._handlers||{},d._handlers[a]=d._handlers[a]||[],d._handlers[a].push({handler:b,context:c,ctx:d}),this},off:function(a,b,c){var d=c||this,e=d._handlers;if(a&&e[a])if(x(b))for(var f=e[a].length-1;f>=0;f--)e[a][f].handler===b&&e[a].splice(f,1);else e[a]=[];return this},trigger:function(a){var b=this,c=[].slice.call(arguments,1),d=b._handlers;return d&&d[a]&&d[a].forEach(function(a){a.handler.apply(b,c)}),this}},I={extend:function(a,c,d){x(c)&&(d=c,c={}),x(a)&&(d=a,a={});var e=this;d=d||function(){return e.apply(this,arguments)};var f=function(){this.constructor=d};return f.prototype=e.prototype,d.prototype=new f,b(d.prototype,a,{__super__:e}),b(d,e,c),d}},J={};c("a-"),b(e,I,{setPrefix:c,Event:H,doc:a}),b(e.prototype,H,{update:function(a,b,c){var d,e=this._vm;return v(a)?(c=b,d=b=a):"string"==typeof a?(a=B(a).join("."),w(b)&&(b=this.get(a)),d=C(a,b,{}),e=e.$getChild(a)):b=this.data,w(c)&&(c=v(a)),e.$render(b,c),this.trigger("update",d),this},render:function(a){return a&&this.set(a,{isExtend:!1,silence:!0}),this._vm.$render(this.data,!1),this.isRendered=!0,this.trigger("render"),this},clone:function(a){var b=m({},this.options);return a&&a.data&&(b.data=null),new this.constructor(this.tpl,m(b,a))},get:function(a){return D(a,this.data)},set:function(a,b,c){var d,e,f,g,h;if(w(a))return this;if(v(a))d=!0,c=b,c=c||{},c.isExtend!==!1?(e=!0,m(this.data,a,this._vm)):(e=!1,this.data=m({},a,this._vm));else if(c=c||{},D(a,this.data)!==b&&(d=!0),d)if(c.isExtend!==!0){if(g=B(a),g.length>1){if(h=g.pop(),f=D(g.join("."),this.data),w(f))C(g.join("."),f={},this.data);else if(!v(f)){var i=f;C(g.join("."),f={toString:function(){return i}},this.data)}}else a?(f=this.data,h=a):(f=this,h="data");f[h]=v(b)?m(Array.isArray(b)?[]:{},b,this._vm.$getChild(a,!Array.isArray(b))):b,e=!1}else m(this.data,C(a,b,{}),this._vm),e=!0;return d&&!c.silence&&(v(a)?this.update(a,e):this.update(a,b,e)),this},setPartial:function(c){if(c){c=b({},this._partials[c.name],c);var d,g,i,j=c.name,k=c.target,l=c.content,m=c.path||"";if(j&&(this._partials[j]=c),l){if(i=this._vm.$getChild(m),"string"==typeof l)if(c.escape)d=[a.createTextNode(l)];else{g=f(l,"div").el.childNodes,d=[];for(var n=0,o=g.length;o>n;n++)d.push(g[n])}else d=[l instanceof e?l.el:l];if(k)for(var n=0,o=d.length;o>n;n++)x(k)?k.call(this,d[n]):k.appendChild(d[n]);h(d,i),this.isRendered&&i.$render(D(m,this.data))}return this}},init:u,watch:function(a,b){var c=this,d=this._vm.$getChild(a),e=new r(d,{});e.addKey(a),e.callback=b,e.update=function(a){b.call(c,a,c.val),c.val=a},d.$watchers.push(e)},unwatch:function(){},setFilter:function(a,b){this._filters[a]=b.bind(this)},removeFilter:function(a){delete this._filters[a]}});var K=!!a.attachEvent;l.prototype={$root:null,$parent:null,$ant:null,$path:null,$watchers:null,$getChild:function(a,b){var c,d,e,f=this;if(a+="",a&&"."!==a){e=a.split(/(?!^)\.(?!$)/);for(var g=0,h=e.length;h>g;g++){if(c=e[g],!f[c]){if(b)return null;d=new l,d.$parent=f,d.$root=f.$root||f,d.$path=c,f[c]=d}f=f[c]}}return f},$getKeyPath:function(){for(var a=this.$path,b=this;(b=b.$parent)&&b.$path;)a=b.$path+"."+a;return a},$getData:function(a,b){var c=D(a,this.$root.$ant.get(this.$getKeyPath()));return!b&&this.$parent&&w(c)?this.$parent.$getData(a):c},$render:function(a,b){for(var c=b?a:this,d=0,e=this.$watchers.length;e>d;d++)this.$watchers[d].fn(b);if(v(c))for(var f in c)!this.hasOwnProperty(f)||f in l.prototype||this[f].$render(a?a[f]:void 0,b)}};var L=/{{({([^{}\n]+)}|[^{}\n]+)}}/g,M=/^>\s*(?=.+)/,N=[function(a,b){return new r(a,b)},function(b,c){var d,e,f,g;return"text"===c.type&&M.test(c.path)?(d=c.path.replace(M,""),e=b.$root.$ant,f=e.options,g=a.createTextNode(""),c.el.insertBefore(g,c.node),c.el.removeChild(c.node),e.setPartial({name:d,content:f&&f.partials&&f.partials[d],target:function(a){c.el.insertBefore(a,g)},escape:c.escape,path:b.$getKeyPath()}),!1):void 0},function(a,b){return b.nodeName===J.IF||b.nodeName===J.REPEAT?new Q(a,b):void 0},function(a,b){var c=b.path,d=b.el;if(b.nodeName===J.MODEL){if(!c)return!1;var e,f=a.$root.$ant,g="."===c?a:a.$getChild(c),h="change",i=e="value",j=w(f.get(g.$getKeyPath())),k=/\r\n/g,l=function(b){var f=b||a.$getData(c)||"",b=d[e];b&&b.replace&&(b=b.replace(k,"\n")),f!==b&&(d[e]=f)},m=function(){var a=d[i];a.replace&&(a=a.replace(k,"\n")),f.set(g.$getKeyPath(),a)};switch(d.tagName){default:i=e="innerHTML",h+=" blur";case"INPUT":case"TEXTAREA":switch(d.type){case"checkbox":i=e="checked",K&&(h+=" click");break;case"radio":e="checked",K&&(h+=" click"),l=function(){d.checked=d.value===a.$getData(c)},j=d.checked;break;default:f.options.lazy||("oninput"in d&&(h+=" input"),K&&(h+=" keyup propertychange cut"))}break;case"SELECT":d.multiple&&(m=function(){for(var a=[],b=0,c=d.options.length;c>b;b++)d.options[b].selected&&a.push(d.options[b].value);f.set(g.$getKeyPath(),a)},l=function(){var b=a.$getData(c);if(b&&b.length)for(var e=0,f=d.options.length;f>e;e++)d.options[e].selected=-1!==b.indexOf(d.options[e].value)}),j=j&&!n(d[i])}h.split(/\s+/g).forEach(function(a){F(d,a,m),E(d,a,m)}),d.removeAttribute(J.MODEL);var o=new r(g,b);return o.update=l,d[i]&&j&&m(),o}}],O=function(a){var b=this;this._ast=e._parse(a,function(a,c){"filter"===c?b.filters.push(a):b.keys.push(a)})};b(r,{STATE_READY:0,STATE_CALLED:1},I),b(r.prototype,{update:function(b){var c,d=this.token,e=d.position,f=d.node,g=d.el,h=d.type,i=d.textMap,j=d.nodeName,k=n(f.nodeName);if(b+""!=i[e]+""){if((k?j:f.nodeValue)!==i.join("")&&d.escape)return console.warn("模板内容被修改!"),void 0;if(i[e]=b&&b+"",c=i.join(""),d.escape||"text"!==h)k||(f.nodeValue=c),"text"!==h&&(k?(j&&g.removeAttribute(j),c&&s(g,c,f.nodeValue),d.nodeName=c):s(g,j,c));else{var l,m=a.createElement("div");d.unescapeNodes=d.unescapeNodes||[],m.innerHTML=c,l=m.childNodes,d.unescapeNodes.forEach(function(a){a.parentNode&&a.parentNode.removeChild(a)}),d.unescapeNodes=[];for(var o=0,p=l.length;p>o;o++)d.unescapeNodes.push(l[o]),f.parentNode.insertBefore(l[o],f),o--,p--;f.nodeValue=""}}},getValue:function(a){for(var b,c=this.filters,d=this.ant,f=0,g=c.length;g>f;f++)if(!d._filters[c[f]])throw new Error("Filter: "+c[f]+" not found!");try{b=e._eval(this._ast,a,d._filters)}catch(h){b=""}return b}});var P={splice:A([].splice,function(){t(this,"splice",[].slice.call(arguments))}),push:A([].push,function(){var a=[].slice.call(arguments);a.unshift(this.length-a.length,0),t(this,"splice",a)}),pop:A([].pop,function(){t(this,"splice",[this.length,1])}),shift:A([].shift,function(){t(this,"splice",[0,1])}),unshift:A([].unshift,function(){var a=[].slice.call(arguments);a.unshift(0,0),t(this,"splice",a)}),sort:A([].sort,function(){t(this,"sort")}),reverse:A([].reverse,function(){t(this,"reverse")})},Q=r.extend({update:function(a,b){var c=this;if(c.type===J.REPEAT){if(a&&!Array.isArray(a))return console.warn("需要一个数组"),void 0;0!==this.state&&b||a&&this.splice([0,this.els.length].concat(a))}else a?c.lastIfState||c.relateEl.parentNode.insertBefore(c.el,c.relateEl):c.lastIfState&&c.el.parentNode.removeChild(c.el),c.lastIfState=a},splice:function(b,c,d){var e,f,g=this.els,h=b.slice(2),j=1*b[0],k=1*b[1],l=h.length,n=[],o=a.createDocumentFragment(),p=this.relateEl.parentNode;w(k)&&(b[1]=k=g.length-j);for(var q=j,r=g.length;r>q;q++)if(j+k>q){try{p.removeChild(g[q])}catch(s){}d||delete this.vm[q]}else{if(!k&&!l)break;var t=q-(k-l);g[q][G+"index"]=t,d||(f=this.vm[t]=this.vm[q],f.$path=t+"")}for(var t=0;l>t;t++)e=this.el.cloneNode(!0),d||delete this.vm[j+t],f=this.vm.$getChild(j+t),e[G+"index"]=j+t,o.appendChild(e),i(e,f),f.$render(h[t]),n.push(e),c&&v(c[j+t])&&(c[j+t]=m(Array.isArray(c[j+t])?[]:{},c[j+t],f));if(n.length&&p.insertBefore(o,g[j+k]||this.relateEl),!d)for(var u=r-k+l;r>u;u++)delete this.vm[u];b=b.slice(0,2).concat(n),g.splice.apply(g,b),k!==l&&this.vm.$getChild("length").$render(g.length)},reverse:function(b,c,d){for(var e,f=this.vm,g=this.relateEl,h=a.createDocumentFragment(),i=0,j=this.els.length;j>i;i++)!d&&.5>i&&(e=f[i],f[i]=f[j-i-1],f[i].$path=i+"",e.$path=j-i-1+"",f[j-i-1]=e),this.els[i][G+"index"]=j-i-1,h.appendChild(this.els[j-i-1]);g.parentNode.insertBefore(h,g),this.els.reverse()},sort:function(){this.update(this.val)}},function(b,c){var d=a.createTextNode(""),e=c.el,f=c.nodeName;this.__super__.apply(this,arguments),this.path=c.path,e.removeAttribute(f),this.type=f,this.relateEl=d,this.els=[],this.vm=b.$getChild(this.keys[0]),f===J.IF&&i(this.el,b),e.parentNode.insertBefore(d,e),e.parentNode.removeChild(e)}),R=/(?:\.|\[)/g,S=/\]/g;return e}),function(a){var b=Object.create||function(a){function b(){}return b.prototype=a,new b},c=function(a,b){throw b=b||this,b.name="SyntaxError",b.message=a,b},d=function(a,b,d){var e,f,g,h,i,j=0,k=a.length,l=[],m=function(a,b){return{type:a,value:b,from:f,to:j}};if(a){for("string"!=typeof b&&(b="<>+-&"),"string"!=typeof d&&(d="=>&:"),e=a.charAt(j);e;)if(f=j," ">=e)j+=1,e=a.charAt(j);else if(e>="a"&&"z">=e||e>="A"&&"Z">=e){for(i=e,j+=1;e=a.charAt(j),e>="a"&&"z">=e||e>="A"&&"Z">=e||e>="0"&&"9">=e||"_"===e;)i+=e,j+=1;l.push(m("name",i))}else if(e>="0"&&"9">=e){for(i=e,j+=1;e=a.charAt(j),!("0">e||e>"9");)j+=1,i+=e;if("."===e)for(j+=1,i+=e;e=a.charAt(j),!("0">e||e>"9");)j+=1,i+=e;if("e"===e||"E"===e){j+=1,i+=e,e=a.charAt(j),("-"===e||"+"===e)&&(j+=1,i+=e,e=a.charAt(j)),("0">e||e>"9")&&c("Bad exponent",m("number",i));do j+=1,i+=e,e=a.charAt(j);while(e>="0"&&"9">=e)}e>="a"&&"z">=e&&(i+=e,j+=1,c("Bad number",m("number",i))),g=+i,isFinite(g)?l.push(m("number",g)):c("Bad number",m("number",i))}else if("'"===e||'"'===e){for(i="",h=e,j+=1;e=a.charAt(j)," ">e&&(m("string",i),c("\n"===e||"\r"===e||""===e?"Unterminated string.":"Control character in string.",m("",i))),e!==h;){if("\\"===e)switch(j+=1,j>=k&&c("Unterminated string",m("string",i)),e=a.charAt(j)){case"b":e="\b";break;case"f":e="\f";break;case"n":e="\n";break;case"r":e="\r";break;case"t":e="	";break;case"u":j>=k&&c("Unterminated string",m("string",i)),e=parseInt(a.substr(j+1,4),16),(!isFinite(e)||0>e)&&c("Unterminated string",m("string",i)),e=String.fromCharCode(e),j+=4}i+=e,j+=1}j+=1,l.push(m("string",i)),e=a.charAt(j)}else if("/"===e&&"/"===a.charAt(j+1))for(j+=1;e=a.charAt(j),"\n"!==e&&"\r"!==e&&""!==e;)j+=1;else if(b.indexOf(e)>=0){for(i=e,j+=1;;){if(e=a.charAt(j),j>=k||d.indexOf(e)<0)break;i+=e,j+=1}l.push(m("operator",i))}else j+=1,l.push(m("operator",e)),e=a.charAt(j);return l}},e=function(){var a,e,f,g,h={},i=function(){return this},j=function(b){return b.nud=i,b.led=null,b.std=null,b.lbp=0,a&&"."===a.id||g(b.value,a&&"|"===a.id?"filter":"name"),b},k=function(d){var g,i,k,l;return d&&a.id!==d&&c("Expected '"+d+"'.",a),f>=e.length?(a=h["(end)"],void 0):(k=e[f],f+=1,l=k.value,g=k.type,"operator"===g||l in h?(i=h[l],i||c("Unknown operator.",k)):"name"===g?i=j(k):"string"===g||"number"===g?(i=h["(literal)"],g="literal"):c("Unexpected token.",k),a=b(i),a.from=k.from,a.to=k.to,a.value=l,a.arity=g,a)},l=function(b){var c,d=a;for(k(),c=d.nud();b<a.lbp;)d=a,k(),c=d.led(c);return c},m={nud:function(){c("Undefined.",this)},led:function(){c("Missing operator.",this)}},n=function(a,c){var d=h[a];return c=c||0,d?c>=d.lbp&&(d.lbp=c):(d=b(m),d.id=d.value=a,d.lbp=c,h[a]=d),d},o=function(a,b){var c=n(a);return c.nud=function(){return this.value=h[this.id].value,this.arity="literal",this},c.value=b,c},p=function(a,b,c){var d=n(a,b);return d.led=c||function(a){return this.first=a,this.second=l(b),this.arity="binary",this},d},q=function(a,b,c){var d=n(a,b);return d.led=c||function(a){return this.first=a,this.second=l(b-1),this.arity="binary",this},d},r=function(a,b){var c=n(a);return c.nud=b||function(){return this.first=l(70),this.arity="unary",this},c};return n("(end)"),n("(name)"),n(":"),n(")"),n("]"),n("}"),n(","),o("true",!0),o("false",!1),o("null",null),n("(literal)").nud=i,n(".").nud=function(){return this.arity="this",g("."),this},p("?",20,function(a){return this.first=a,this.second=l(0),k(":"),this.third=l(0),this.arity="ternary",this}),q("&&",31),q("||",30),q("===",40),q("!==",40),q("<",40),q("<=",40),q(">",40),q(">=",40),p("+",50),p("-",50),p("*",60),p("/",60),p("%",60),p(".",80,function(b){return this.first=b,"name"!==a.arity&&c("Expected a property name.",a),a.arity="literal",this.second=a,this.arity="binary",k(),this}),p("[",80,function(a){return this.first=a,this.second=l(0),this.arity="binary",k("]"),this}),p("(",80,function(b){var c=[];if("."===b.id||"["===b.id?(this.arity="ternary",this.first=b.first,this.second=b.second,this.third=c):(this.arity="binary",this.first=b,this.second=c,"unary"===b.arity&&"function"===b.id||"name"===b.arity||"("===b.id||"&&"===b.id||"||"===b.id||"?"===b.id||b.error("Expected a variable name.")),")"!==a.id)for(;;){if(c.push(l(0)),","!==a.id)break;k(",")}return k(")"),this}),p("|",10,function(b){var c;if(this.first=b,a.arity="filter",this.second=l(0),this.arity="binary",":"===a.id)for(this.arity="ternary",this.third=c=[];;)if(k(":"),c.push(l(0)),":"!==a.id)break;return this}),r("!"),r("-"),r("typeof"),r("(",function(){var a=l(0);return k(")"),a}),r("[",function(){var b=[];if("]"!==a.id)for(;;){if(b.push(l(0)),","!==a.id)break;k(",")}return k("]"),this.first=b,this.arity="unary",this}),r("{",function(){var b,d,e=[];if("}"!==a.id)for(;;){if(b=a,"name"!==b.arity&&"literal"!==b.arity&&c("Bad property name.",a),k(),k(":"),d=l(0),d.key=b.value,e.push(d),","!==a.id)break;k(",")}return k("}"),this.first=e,this.arity="unary",this}),function(a,b){e=d(a,"=<>!+-*&|/%^","=<>&|"),f=0,g="function"==typeof b?b:function(){},k();var c=l(0);return k("(end)"),c}},f={unary:{"+":function(a){return+a},"-":function(a){return-a},"!":function(a){return!a},"[":function(a){return a},"{":function(a){for(var b={},c=0,d=a.length;d>c;c++)b[a[c][0]]=a[c][1];return b},"typeof":function(a){return typeof a}},binary:{"+":function(a,b){return a+b},"-":function(a,b){return a-b},"*":function(a,b){return a*b},"/":function(a,b){return a/b},"%":function(a,b){return a%b},"<":function(a,b){return b>a},">":function(a,b){return a>b},"<=":function(a,b){return b>=a},">=":function(a,b){return a>=b},"==":function(a,b){return a==b},"!=":function(a,b){return a!=b},"===":function(a,b){return a===b},"!==":function(a,b){return a!==b},"&&":function(a,b){return a&&b},"||":function(a,b){return a||b},".":function(a,b){return a[b]},"[":function(a,b){return a[b]},"(":function(a,b){return a.apply(null,b)},"|":function(a,b){return b.call(null,a)}},ternary:{"?":function(a,b,c){return a?b:c},"(":function(a,b,c){return a[b].apply(a,c)},"|":function(a,b,c){return b.apply(null,[a].concat(c))}}},g=function(){function a(a,b){return f[a][b]||function(){return""}}var b,c,d=Array.isArray,e=["first","second","third"],g=function(f){for(var h,i=f.arity,j=f.value,k=[],l=0;3>l;l++)if(h=f[e[l]])if(d(h)){k[l]=[];for(var m=0,n=h.length;n>m;m++)k[l].push("undefined"==typeof h[m].key?g(h[m]):[h[m].key,g(h[m])])}else k[l]=g(h);switch(i){case"unary":case"binary":case"ternary":return a(i,j)(k[0],k[1],k[2]);case"literal":return j;case"name":return b[j];case"filter":return c[j];case"this":return b}};return function(a,d,e){return b="undefined"==typeof d?{}:d,c=e||{},g(a)}};a._eval=g(),a._parse=e()}(Ant);